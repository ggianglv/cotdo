<!-- 博文的布局-Layout -->
<!DOCTYPE html>
<html>
<head>
<!-- 引入head标签 -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-sclable=0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="description" content="làm việc với các framework frontend như Vue, Angular hay React thì sẽ không ít lần dùng các thư viện datepicker, bài này sẽ hướng dẫn bạn tạo component datepicker bằng javascript thuần" />
<meta name="keywords" content="" />
<link rel="stylesheet" href="/assets/css/style.css">
<link rel="stylesheet" href="/assets/css/media.css">
<link rel="stylesheet" href="/assets/css/animate.min.css">
<link rel="stylesheet" href="/assets/css/pygments/pygments_default.css">
<link rel="stylesheet" href="/assets/css/github-markdown.css">
<!-- SNS-icon -->
<script src="//at.alicdn.com/t/font_856428_y9z6nq7zf5.js"></script>
<!-- share.css -->
<link rel="stylesheet" href="/assets/css/share.min.css">
<!-- font -->
<link rel="stylesheet" href="/assets/css/font.css">
<!-- <link href="https://fonts.googleapis.com/css?family=Kaushan+Script|Pacifico|Ubuntu|Roboto+Mono|Source+Sans+Pro" rel="stylesheet"> -->

<!-- Favicon -->
<link href="/assets/profile.jpg" rel="shortcut icon" />
<link href="/assets/profile.jpg" rel="apple-touch-icon-precomposed" />
<!-- Android Lolipop Theme Color -->
<!-- <meta name="theme-color" content="#1464FB"> -->
<title>Viết component datepicker bằng javascript thuần</title>
<!-- 百度统计 -->

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

<!-- 谷歌分析 -->


<!-- Android Lolipop Theme Color -->
<meta name="theme-color" content=" rgb(255,210,32) ">
</head>
<body>

<!-- 顶部锚点 -->
<a id="htmlup" name="htmlup"></a>
<!-- 引入博文顶部选项 -->

<header id="post-header" style="background-color:rgb(255,210,32);">
  <div class="top-center">
      <div class="logo">
          <a href="/" title="my awesome webtitle" style="color: white;">Cốt đơ</a>
      </div>
      <nav class="top-nav">
          <ul>
              
                <li><a href="/" style="color: white;">Home</a></li>
              
                <li><a href="/tags.html" style="color: white;">Tags</a></li>
              
                <li><a href="/timeline.html" style="color: white;">Timeline</a></li>
              
                <li><a href="/about.html" style="color: white;">About</a></li>
              
          </ul>
      </nav>
      <div id="top-boot">
        <a href="javascript:;" id="boot1" style="display:block;" onclick="document.getElementById('boot-area').style.display='block';document.getElementById('boot1').style.display='none';document.getElementById('boot2').style.display='block';"><img src="/assets/boot_white.png" alt=""></a>
        <a href="javascript:;" id="boot2" style="display: none;" onclick="document.getElementById('boot-area').style.display='none';document.getElementById('boot1').style.display='block';document.getElementById('boot2').style.display='none';"><img src="/assets/boot_white.png" alt=""></a>
      </div>
  </div>

</header>


<!-- 引入移动下拉选项 -->
<div id="boot-area">
    <ul>
        
          <a href="/"><li>Home</li></a>
        
          <a href="/tags.html"><li>Tags</li></a>
        
          <a href="/timeline.html"><li>Timeline</li></a>
        
          <a href="/about.html"><li>About</li></a>
        
    </ul>
</div>

<!-- 引入博文顶部样式 -->
<!-- 版本一 垃圾 -->
<!-- <div class="wow fadeIn top" data-wow-duration="3.5s" >
    <span class="wow fadeInUp" data-wow-delay="0.2s">Viết component datepicker bằng javascript thuần</span>
    <span class="wow fadeInUp" data-wow-delay="0.4s">làm việc với các framework frontend như Vue, Angular hay React thì sẽ không ít lần dùng các thư viện datepicker, bài này sẽ hướng dẫn bạn tạo component datepicker bằng javascript thuần</span>
    <span class="wow fadeInUp" data-wow-delay="0.4s">làm việc với các framework frontend như Vue, Angular hay React thì sẽ không ít lần dùng các thư viện datepicker, bài này sẽ hướng dẫn bạn tạo component datepicker bằng javascript thuần</span>
    <span class="wow fadeInUp" data-wow-delay="0.6s">作者&nbsp;&nbsp;|&nbsp;&nbsp;Giangg</span>
</div> -->

<!-- 版本二 可切换页面 -->

<div class="post-top" style="background-color:rgb(255,210,32);">
  <!-- 页面宽度大于800px -->
  <div class="left-area">
    
      <a href="javascript:;" class="btn bounceInLeft animated" onmouseover="showLeft();this.style.color='rgb(255,210,32)';" onmouseout="goneLeft();this.style.color='rgba(0,0,0,.2)';"><</a>
      <div id="left-tab" style="display:none;"><span class="left-san"></span><span class="left-main" style="color:rgb(255,210,32);"><sapn class="main">没有上一页咯</sapn></span></div>
    
  </div>
  <div class="post-titlearea">
    <h1 class="wow fadeInUp" data-wow-delay="0.2s">Viết component datepicker bằng javascript thuần</h1>
    <!-- <span class="wow fadeInUp" data-wow-delay="0.4s">làm việc với các framework frontend như Vue, Angular hay React thì sẽ không ít lần dùng các thư viện datepicker, bài này sẽ hướng dẫn bạn tạo component datepicker bằng javascript thuần</span> -->
    <!-- <span class="wow fadeInUp" data-wow-delay="0.4s">làm việc với các framework frontend như Vue, Angular hay React thì sẽ không ít lần dùng các thư viện datepicker, bài này sẽ hướng dẫn bạn tạo component datepicker bằng javascript thuần</span> -->
    <!-- <span class="wow fadeInUp" data-wow-delay="0.6s">作者&nbsp;&nbsp;|&nbsp;&nbsp;Giangg</span> -->
  </div>
  <div class="right-area">
    
      <a href="javascript:;" class="btn bounceInRight self-animated" onmouseover="showRight();this.style.color='rgb(255,210,32)';" onmouseout="goneRight();this.style.color='rgba(0,0,0,.2)';">></a>
      <div id="right-tab" style="display:none;"><span class="right-san"></span><span class="right-main" style="color:rgb(255,210,32);"><sapn class="main"></sapn>...</sapn></span></div>
    
  </div>

  <!-- 页面宽度小于800px -->
  <div class="post-changearea">
    
      <a href="javascript:;" class="leftchange" style="border-right: 1px solid rgb(255,210,32);border-bottom: 2px solid rgb(255,210,32);"><span><br>...</span></a>
    
    
      <a href="javascript:;" class="rightchange" style="border-left: 1px solid rgb(255,210,32);border-bottom: 2px solid rgb(255,210,32);"><span><br>...</span></a>
    
  </div>
</div>


<div class="markdown-body fadeInUp animated">

  

  <!-- 文章内容 -->
  <p>Khi các bạn làm việc với các framework frontend như Vue, Angular hay React (thực ra nó là thư viện, nhưng mình cứ coi như nó là framework đi), bạn sẽ không ít lần dùng các thư viện datepicker có ở trên github. Đã bao giờ bạn tự hỏi rằng những thư viện này được viết như thế nào chưa? Lúc đầu mình cũng nghĩ những thư viện này ẩn chứa 1 thuật toán rất chi là cao siêu, nhưng khi bắt đầu viết cho mình 1 component datepicker thì lại thấy nó cực kỳ đơn giản. Hãy cùng bắt đầu nhé</p>

<h2 id="thành-quả">Thành quả</h2>

<p>Đây là kết quả cuối cùng của component. Mình có sử dụng thư viện NES css để trông cho đẹp mắt hơn. demo thì ở đây <a href="https://gianglevan94.github.io/ugly-date-picker">nes datepicker</a></p>

<p><img src="/assets/images/nes-datepicker.png" alt="datepicker" /></p>

<h2 id="thuật-toán">Thuật toán</h2>

<p>Mô ta 1 chút về component datepicker này. Như các bạn thấy nó sẽ gồm 35 ô số có thể chứa ngày của tháng hiện tại, ngày của tháng trước, và ngày của tháng kế tiếp. Ngày đầu tiên của tháng hiện tại sẽ luôn nằm ở hàng đầu tiên, vậy mấu chốt ở đây là bạn phải xác định được ngày đầu tiên của tháng là vào thứ mấy, rồi từ đấy fill vào các ô trước đó là ngày của tháng trước. Dưới đây là một vài đoạn code của thuật thoán.</p>

<p>Đầu tiên là init các ngày của mảng mình sẽ có hàm <code class="highlighter-rouge">getDays</code> bên trong đấy sẽ có 2 hàm là <code class="highlighter-rouge">getDaysOfPrevMonth</code> và <code class="highlighter-rouge">getDaysOfMonth</code> sẽ trả về các ngày của tháng trước, và các ngày sau đó. Vì sao đoạn này mình lại <code class="highlighter-rouge">days.slice(0, MAX_DAYS)</code> ? Đoạn này do mình lười tính toàn số ngày của tháng hiện tại và tháng tiếp đó nên mình sẽ lấy dư ra vài ngày và cắt bớt. Bạn đọc code sẽ hiểu thêm.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">getDays</span> <span class="o">=</span> <span class="p">(</span><span class="nx">month</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">days</span> <span class="o">=</span> <span class="p">[...</span><span class="nx">getDaysOfPrevMonth</span><span class="p">(</span><span class="nx">month</span><span class="p">),</span> <span class="p">...</span><span class="nx">getDaysOfMonth</span><span class="p">(</span><span class="nx">month</span><span class="p">)];</span>

  <span class="k">return</span> <span class="nx">days</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">MAX_DAYS</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Đây là hàm lấy gày của tháng hiện tại như bạn có thể thấy là hàm <code class="highlighter-rouge">getFirstDayIndex</code> sẽ trả về ngày đầu tiên của tháng là index thứ bao nhiêu của mảng. Sau đó sẽ lùi dần về ngày của các tháng trước đó</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">getDaysOfPrevMonth</span> <span class="o">=</span> <span class="p">(</span><span class="nx">month</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">firstDayIndex</span> <span class="o">=</span> <span class="nx">getFirstDayIndex</span><span class="p">(</span><span class="nx">month</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">days</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">firstDayIndex</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
    <span class="nx">now</span><span class="p">.</span><span class="nx">setMonth</span><span class="p">(</span><span class="nx">month</span><span class="p">);</span>
    <span class="nx">now</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">diffDate</span> <span class="o">=</span> <span class="nx">firstDayIndex</span> <span class="o">-</span> <span class="nx">i</span><span class="p">;</span>
    <span class="nx">now</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="nx">now</span><span class="p">.</span><span class="nx">getDate</span><span class="p">()</span> <span class="o">-</span> <span class="nx">diffDate</span><span class="p">);</span>
    <span class="nx">days</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">now</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">days</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Mình sẽ dùng hàm <code class="highlighter-rouge">getDay</code> để lấy ra thứ hiện tại trong tháng (thứ 2, chủ nhật…) đồng thời cũng là index của mảng luôn. Ngoài ra javascript còn có hàm <code class="highlighter-rouge">getDate</code> trả về ngày hôm đấy là ngày bao nhiêu của tháng nữa. 2 hàm này rất dễ lẫn lộn với nhau.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">getFirstDayIndex</span> <span class="o">=</span> <span class="p">(</span><span class="nx">month</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
  <span class="nx">now</span><span class="p">.</span><span class="nx">setMonth</span><span class="p">(</span><span class="nx">month</span><span class="p">);</span>
  <span class="nx">now</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

  <span class="k">return</span> <span class="nx">now</span><span class="p">.</span><span class="nx">getDay</span><span class="p">();</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Tiếp đến sẽ là hàm lấy tất cả những ngày còn lại. <code class="highlighter-rouge">MAX_DAYS</code> của mình đang để là 35.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">getDaysOfMonth</span> <span class="o">=</span> <span class="p">(</span><span class="nx">month</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">days</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">MAX_DAYS</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
    <span class="nx">now</span><span class="p">.</span><span class="nx">setMonth</span><span class="p">(</span><span class="nx">month</span><span class="p">);</span>
    <span class="nx">now</span><span class="p">.</span><span class="nx">setDate</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
    <span class="nx">days</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">now</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">days</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Khá là đơn giản đúng không. Như vừa rồi mình đã generate ra được 1 mảng 35 phần tử có chứa các ngày trong tháng để hiện lên calendar rồi. Việc còn lại chỉ là loop rồi hiển thị ra màn hình, đoạn này mình sẽ không đi chi tiết do bài này mình chỉ muốn giải thích về thuật toán để render ra cái calendar thôi. Khi đã render ra calendar thì mình nghĩ đã xong đến 70% component rồi. Ngoài ra sẽ còn những thứ râu ria như là: nút chuyển tháng, input, style cho đẹp…, cái này mình không đề cập ở đây. Bạn có thể xem source code hoàn chỉnh ở đây nhé <a href="https://github.com/gianglevan94/ugly-date-picker">https://github.com/gianglevan94/ugly-date-picker</a></p>

<h2 id="lời-kết">Lời kết</h2>
<p>Vừa rồi là một bài hướng dẫn nho nhỏ về viết component datepicker bằng javascript thuần. Hi vọng bài viết sẽ hữu ích cho các bạn. Các bạn có thể tự build 1 component datepicker cho riêng mình (không khuyến khích), thay vì phải dùng những thư viện trên mạng có nhiều tính năng thừa thãi mà bạn không dùng đến cũng như sẽ dễ dàng tùy biến hơn tùy vào dự án và yêu cầu của khác hàng. Cám ơn các bạn đã đọc bài!</p>


  <!-- 引入share模块 -->
  
  <div class="social-share-wrapper">
    <div class="social-share"></div>
  </div>


<!-- share.js -->
<script src="/assets/js/social-share.min.js"></script>
<script>
  socialShare('.social-share', {
    sites: [
      
        'twitter'
        ,
        
      
        'facebook'
        
      
    ],
    wechatQrcodeTitle: "分享到微信朋友圈",
    wechatQrcodeHelper: '期待在朋友圈见到这篇文章'
  });
</script>

</div>

<!-- 底部锚点 -->
<a id="htmldown" name="htmldown"></a>
<!-- 引入评论模块 -->

    <section class="post-footer-item comment">
      <div id="disqus_thread"></div>
    </section>

    <script>
      /**
       *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
       *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
      /*
      var disqus_config = function () {
      this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
      };
      */
      (function() { // DON'T EDIT BELOW THIS LINE
        var d = document,
          s = d.createElement('script');
        /*写入自己的disqus信息*/
        s.src = '';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })();

    </script>







<!-- 引入goto模块 -->
<div class="bounceInRight animated go">
  <a title="顶部切换页面" class="gototop" href="#htmlup" target="_self">
    <div class="box" style="font-family:'ffad_matroregular';">
        Top
    </div>
  </a>
  <a title="底部有disqus评论哦" class="gotobottom" href="#htmldown" target="_self">
    <div class="box" style="font-family:'ffad_matroregular';">
        Foot
    </div>
  </a>
</div>

<!-- 引入页面底部模块 -->
<footer id="bottom">
  <br>
  <span>Cốt đơ ©
  
  
  2020
  <br>
  Powered by <a href="https://www.jekyll.com.cn/">Jekyll</a> | <a href="https://github.com/xukimseven/HardCandy-Jekyll">HardCandy-Jekyll</a></span>
</footer>


<!-- 引用wow.js的动画效果 -->
<script src="/assets/js/wow.js"></script>
<script>
    var wow = new WOW({
        boxClass: 'wow',
        animateClass: 'animated',
        // offset: 600,
        mobile: true,
        live: true
    });
    wow.init();
</script>
<!-- 页面刷新回到顶部 -->
<script>
    window.onbeforeunload = function(){
        //刷新后页面自动回到顶部
        document.documentElement.scrollTop = 0;  //ie下
        document.body.scrollTop = 0;  //非ie
    }
</script>
<script src="/assets/js/main.js"></script>
</body>
</html>
